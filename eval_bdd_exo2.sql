--1. SELECT CompanyName AS Société,ContactName AS Contact, ContactTitle AS Fonction, Phone AS Téléphone FROM customers WHERE Country = 'France';
--2. SELECT products.ProductName AS Produit, products.UnitPrice AS Prix FROM products JOIN suppliers ON suppliers.SupplierID=products.SupplierID WHERE suppliers.CompanyName = 'Exotic Liquids';
--3. SELECT suppliers.CompanyName AS Fournisseurs, COUNT(products.ProductID) AS "Nbre produits" FROM suppliers JOIN products ON suppliers.SupplierID=products.SupplierID WHERE suppliers.Country = 'France' GROUP BY suppliers.CompanyName ORDER BY suppliers.CompanyName DESC;
--4. SELECT customers.CompanyName AS "Client", COUNT(orders.OrderID) AS `Nbre commandes` FROM customers JOIN orders ON orders.CustomerID=customers.CustomerID WHERE customers.Country='France' GROUP BY customers.CompanyName;
--5. SELECT customers.CompanyName AS "Client", SUM(OD.UnitPrice*OD.Quantity) AS `CA`, customers.Country AS Pays FROM customers JOIN orders AS o ON o.CustomerID=customers.CustomerID JOIN `order details` AS `od` ON `od`.OrderID=o.OrderID GROUP BY customers.CompanyName HAVING `CA` > 30000 ORDER BY `CA` DESC;
--6. SELECT DISTINCT(customers.Country) AS Pays FROM customers JOIN orders ON orders.CustomerID=customers.CustomerID JOIN `order details` AS od ON od.OrderID=orders.OrderID JOIN products ON products.ProductID=od.ProductID JOIN suppliers ON suppliers.SupplierID=products.SupplierID WHERE suppliers.CompanyName = 'Exotic Liquids'GROUP BY Pays ORDER BY Pays ASC;
--7. SELECT SUM(UnitPrice*Quantity) AS "Montant ventes 97" FROM `order details` AS od JOIN orders ON od.OrderID=orders.OrderID AND YEAR(orders.OrderDate) = 1997;
--8. SELECT MONTH(orders.OrderDate) AS "Mois 97", SUM(UnitPrice*Quantity) AS "Montant ventes" FROM `order details` AS od JOIN orders ON od.OrderID=orders.OrderID AND YEAR(orders.OrderDate) = 1997 GROUP BY MONTH(orders.OrderDate);
--9. SELECT MAX(orders.OrderDate) AS "Date de dernière commande" FROM orders JOIN customers ON customers.CustomerID=orders.CustomerID WHERE customers.CompanyName='Du monde entier';
--10. SELECT CONVERT(AVG(DATEDIFF(orders.ShippedDate,orders.OrderDate)),INTEGER) AS "Date de dernière commande" FROM orders;